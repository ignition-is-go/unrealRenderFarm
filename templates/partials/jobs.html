<section class="jobs-section">
    <h2>Jobs
        {% if requests %}
        <button class="btn-delete-all"
                hx-delete="/api/delete-all"
                hx-confirm="Delete all {{ requests|length }} jobs?"
                hx-swap="none">Delete All</button>
        {% endif %}
    </h2>
    {% if requests %}
    <table>
        <thead>
            <tr>
                <th>UID</th>
                <th>Name</th>
                <th>Owner</th>
                <th>Worker</th>
                <th>Status</th>
                <th>Warmup</th>
                <th>Progress</th>
                <th>Time Estimate</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for job in requests %}
            <tr>
                <td>{{ job.uid }}</td>
                <td>{{ job.name }}</td>
                <td>{{ job.owner }}</td>
                <td>{{ job.worker or '-' }}</td>
                <td>{{ job.status }}</td>
                <td>
                    {% if job.warmup_total > 0 %}
                    {{ job.warmup_current }}/{{ job.warmup_total }}
                    {% else %}
                    -
                    {% endif %}
                </td>
                <td>
                    <div class="progressContainer">
                        <div class="progressBar" style="width: {{ job.progress }}%">{{ job.progress }}%</div>
                    </div>
                </td>
                <td>{{ job.time_estimate or '-' }}</td>
                <td>
                    {% if job.status not in ['finished', 'cancelled'] %}
                    <button class="btn-cancel"
                            hx-post="/api/cancel/{{ job.uid }}"
                            hx-swap="none">Cancel</button>
                    {% else %}
                    <button class="btn-delete"
                            hx-delete="/api/delete/{{ job.uid }}"
                            hx-target="closest tr"
                            hx-swap="delete">Delete</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="no-data">No jobs in queue</p>
    {% endif %}
</section>
